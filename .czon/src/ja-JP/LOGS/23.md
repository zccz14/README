---
"title": "Agent翻訳タスクのパフォーマンス分析と改善案"
"summary": "本稿では、Agentが翻訳タスクにおいてone-shot LLMに及ばない理由を分析します。これには、トークン使用量の多さ、翻訳品質の低下、YAML Frontmatterのフォーマットエラーなどの問題が含まれます。著者は、Agentの設計は多段階の推論と意思決定タスクにより適しており、そのコンテキスト管理戦略が翻訳に情報を十分に活用できない原因であると考えています。また、少数言語の翻訳時にAgentが無限ループに陥る可能性についても言及しています。これらの問題に対し、著者は二つの改善案を提案しています：Agents/Sub-Agentsフレームワークを用いて翻訳タスクを分解する方法、またはSkillを組み立ててLow-level one-shot LLM APIを利用する方法です。著者は前者の案をより好み、OpenCodeが複雑なAgent呼び出しをどの程度サポートしているかについても議論しています。最後に、CZONバージョン0.5.0から0.5.2までの更新履歴（OpenCodeの統合、ネットワーク問題の修正、Agent翻訳機能のロールバックなど）を振り返ります。"
"tags":
  - "Agent"
  - "翻訳タスク"
  - "LLM"
  - "OpenCode"
  - "CZON"
  - "パフォーマンス分析"
  - "改善案"
"date": "2026-01-23"
---

現在は2026年1月23日、未明です。

残念ながら、Agentは翻訳タスクにおいて、one-shot LLMによる直接翻訳よりもパフォーマンスが劣ることが判明しました。どうやら、Agentの強みは、単純な単一ステップのタスクというより、多段階の推論と意思決定を必要とするタスクにあるようです。Agentが使用するトークン数はLLMの10倍にもなりますが、翻訳品質はむしろ低下しており、特にYAML Frontmatterがフォーマットエラーを起こして翻訳されてしまうという問題も発生しています。

私は当初、長文翻訳タスクにおいて最大出力長制限を超えてしまうone-shot LLMの問題を解決するためにAgentを利用しようと考えていましたが、それはそれほど単純ではないようです。そのため、CZON@0.5.2バージョンではこの機能をロールバックし、長期的な視点で再検討することにしました。

これは、Agentが通常、膨大な情報量を扱う複雑なタスクを想定して設計されているためではないかと考えています。そのため、コンテキストの読み書きを可能な限り少なくし、ファイルへの局所的な読み書きを優先する設計となっており、これによりAgentのデータ処理上限を引き上げているのでしょう。このコンテキスト管理戦略のため、すべての情報をデフォルトでは取り込まず、その結果、one-shot LLMのようにコンテキスト情報を十分に活用して翻訳を行うことができなくなっているのです。

興味深いことに、一部の少数言語（例えば簡体中国語からインドネシア語など）への翻訳タスクでは、Agentが偶然にも翻訳を繰り返す無限ループ状態に陥り、安定した翻訳結果に収束できないことがあります。これは、Editツールが特定の言語を処理する際に欠陥があり、テキストを正しく置換できないために無限ループが発生している可能性があります。（あまりに節約しすぎるのも問題かもしれません）

私は二つの解決案を考えています：

1.  Agents / Sub-Agentsフレームワークを用いて翻訳タスクを分解する方法。例えば、翻訳と校正を行う対抗生成フレームワークなどです。
2.  Skillを組み立てて、Low-levelのone-shot LLM APIを利用し、Agent自身が翻訳するのではなく、Agentに翻訳スキルを呼び出させる方法です。

おそらく私は最初の案の方を好みます。なぜなら、その方が上限が高そうだからです。ただ、OpenCodeが複雑なAgent呼び出しをどの程度サポートしているかは分かりません。

また、CZONの更新履歴は以下の通りです：

-   0.5.0: 翻訳タスクにOpenCodeを統合しました。（ただし、大量のファイルを翻訳する際のパフォーマンス問題を引き起こし、後に修正）
-   0.5.1: 国内ネットワークからjsdelivrにアクセスできないために発生していた、フロントエンド静的リソース（tailwindcss）の読み込み失敗問題を修正しました。（ビルド時にCDNファイルをローカルにダウンロードすることで実現）
-   0.5.2: slugが既に存在する場合、slugを更新しないように変更し、コンテンツの修正によってslugが変化するのを防止しました。（ログファイルのリネームによる過去リンクの無効化を回避）；Agent翻訳機能をロールバックし、OpenCode統合による翻訳タスク機能を廃止しました。